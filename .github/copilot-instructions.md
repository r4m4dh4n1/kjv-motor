## Purpose

Short instructions to help an AI coding agent be immediately productive in this repo.

## Quick start (commands)

- Install dependencies: `npm i`
- Run dev server: `npm run dev` (Vite)
- Build: `npm run build`
- Lint: `npm run lint`

## Big picture

- Stack: Vite + TypeScript + React. UI primitives are shadcn/Tailwind components in `src/components/ui/*`.
- Routing and access: `src/App.tsx` uses `react-router-dom`. Authentication wrapper: `src/hooks/useAuth.tsx` and `ProtectedRoute` (`src/components/ProtectedRoute.tsx`).
- Data layer: Supabase. Client lives in `src/integrations/supabase/client.ts` (public key present — it's the publishable key). Database types are generated at `src/integrations/supabase/types.ts` so use those types for safe queries.

## Where to look for the dashboard and menu logic

- Main app shell and menu selection: `src/pages/Index.tsx`. It renders different pages based on `activeMenu` and `selectedDivision`.
- Dashboard implementation: `src/components/Dashboard.tsx` — this file contains the data fetching logic, charts (Recharts), UI cards, and modals. Most feature work for dashboard metrics happens here (queries, transforms, and rendering).

## Common patterns & conventions (project-specific)

- Path alias: `@/*` maps to `src/*` (see `tsconfig.json`). Use `@/` imports when editing files.
- Supabase usage:
  - Import: `import { supabase } from "@/integrations/supabase/client"`
  - Queries follow the PostgREST style: `supabase.from('pembelian').select('*').eq('status','ready')`.
  - DB types are available: use `Tables<'table_name'>` from `src/integrations/supabase/types.ts` to type query results.
- Date and status conventions:
  - Dates are stored as strings (YYYY-MM-DD) and compared as strings in many components.
  - `divisi` is a string field used everywhere to scope data (examples: 'sport', 'start', 'all').
  - `status` values may be mixed-case (e.g. `'Booked'` and `'booked'`) — code often checks both.

## Editing the dashboard (example tasks & tips)

- To add a new metric card:

  1. Add new fields to the `stats` state object in `src/components/Dashboard.tsx`.
  2. Add the SQL/Supabase query in `fetchDashboardData()` (follow existing pattern: build query, apply `selectedDivision` and `selectedCabang` filters, then `Promise.all`).
  3. Compute the metric from query results and set it on `stats`, then render a new Card in the grid.

- Example query pattern in this project:
  - `const pembelianReady = await supabase.from('pembelian').select('*').eq('status','ready')`
  - When checking booked status, the code uses `.in('status', ['Booked','booked'])` to be robust.

## Integration points & DB migration workflow

- Supabase migrations: `supabase/migrations/*` and SQL scripts in the repo root for retroactive fixes. When changing DB schema, update migrations and regenerate `src/integrations/supabase/types.ts`.
- Supabase client config: `supabase/config.toml` (repo-level) and `src/integrations/supabase/client.ts` (runtime client). The latter is generated; avoid hard-editing if it's regenerated by tooling.

## Files & locations you will edit frequently

- UI / components: `src/components/*` (dashboard, layout, ui primitives)
- Pages: `src/pages/*` (Index, Auth, Settings, etc.)
- Integrations: `src/integrations/supabase/*` (client, types)
- Hooks: `src/hooks/*` (auth, toast, pagination, etc.)

## Testing / linting / verification

- No test runner configured in package.json; use `npm run lint` to validate code style with ESLint.
- Quick manual check: start dev server and navigate to the dashboard at `/` (requires auth). Use the `Auth` page (`/auth`) to sign in for local testing.

## Small safety notes

- `src/integrations/supabase/client.ts` contains a publishable key (intended for client-side use). Do not treat it like a secret key — but avoid embedding service-role keys in client code.
- When changing database migrations, remember to regenerate or update the `types.ts` used by the app.

## If you need more context

- Open these files first:
  - `src/components/Dashboard.tsx` (data + UI)
  - `src/pages/Index.tsx` (menu -> which page is rendered)
  - `src/integrations/supabase/client.ts` and `src/integrations/supabase/types.ts`
  - `src/hooks/useAuth.tsx` and `src/components/ProtectedRoute.tsx` (auth flows)
  - `package.json` (scripts and deps)

If anything above is unclear or you want the file to emphasize different examples, tell me which parts to expand or adjust.
